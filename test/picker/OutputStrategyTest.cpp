#include <memory>
#include <sstream>
#include <string>

#include "catch2/catch_test_macros.hpp"

#include "Bracket.hpp"
#include "OutputStrategy_OStream.hpp"
#include "TestUtils.hpp"

namespace {
std::string getExpectedOutput( )
{
  return R"(Region Name - Region 1:
___________A1____________
                            ___________A1____________
___________P1____________
                                                        ___________A1____________
___________H1____________
                            ___________H1____________
___________I1____________
                                                                                    ___________A1____________
___________E1____________
                            ___________E1____________
___________L1____________
                                                        ___________D1____________
___________D1____________
                            ___________D1____________
___________M1____________
                                                                                                                ___________A1____________
___________F1____________
                            ___________F1____________
___________K1____________
                                                        ___________C1____________
___________C1____________
                            ___________C1____________
___________N1____________
                                                                                    ___________B1____________
___________G1____________
                            ___________G1____________
___________J1____________
                                                        ___________B1____________
___________B1____________
                            ___________B1____________
___________O1____________

Region Name - Region 2:
___________A2____________
                            ___________A2____________
___________P2____________
                                                        ___________A2____________
___________H2____________
                            ___________H2____________
___________I2____________
                                                                                    ___________A2____________
___________E2____________
                            ___________E2____________
___________L2____________
                                                        ___________D2____________
___________D2____________
                            ___________D2____________
___________M2____________
                                                                                                                ___________A2____________
___________F2____________
                            ___________F2____________
___________K2____________
                                                        ___________C2____________
___________C2____________
                            ___________C2____________
___________N2____________
                                                                                    ___________B2____________
___________G2____________
                            ___________G2____________
___________J2____________
                                                        ___________B2____________
___________B2____________
                            ___________B2____________
___________O2____________

Region Name - Region 3:
___________A3____________
                            ___________A3____________
___________P3____________
                                                        ___________A3____________
___________H3____________
                            ___________H3____________
___________I3____________
                                                                                    ___________A3____________
___________E3____________
                            ___________E3____________
___________L3____________
                                                        ___________D3____________
___________D3____________
                            ___________D3____________
___________M3____________
                                                                                                                ___________A3____________
___________F3____________
                            ___________F3____________
___________K3____________
                                                        ___________C3____________
___________C3____________
                            ___________C3____________
___________N3____________
                                                                                    ___________B3____________
___________G3____________
                            ___________G3____________
___________J3____________
                                                        ___________B3____________
___________B3____________
                            ___________B3____________
___________O3____________

Region Name - Region 4:
___________A4____________
                            ___________A4____________
___________P4____________
                                                        ___________A4____________
___________H4____________
                            ___________H4____________
___________I4____________
                                                                                    ___________A4____________
___________E4____________
                            ___________E4____________
___________L4____________
                                                        ___________D4____________
___________D4____________
                            ___________D4____________
___________M4____________
                                                                                                                ___________A4____________
___________F4____________
                            ___________F4____________
___________K4____________
                                                        ___________C4____________
___________C4____________
                            ___________C4____________
___________N4____________
                                                                                    ___________B4____________
___________G4____________
                            ___________G4____________
___________J4____________
                                                        ___________B4____________
___________B4____________
                            ___________B4____________
___________O4____________

Final Four:
___________A1____________
                            ___________A1____________
___________A2____________
                                                        ___________A1____________
___________A3____________
                            ___________A3____________
___________A4____________
)";
}

}// namespace

TEST_CASE("OutputStrategy - expected output", "[OutputStrategy]")// NOLINT
{
  const auto selectionStrategy = std::make_shared<LexicographicCompareStrategy>( );
  const auto bracket = picker::makeBracket(getTestBracketData( ), selectionStrategy);

  std::stringstream out{ };
  const picker::OStreamStrategy outputStrategy(&out);
  outputStrategy.writeOutput(bracket);
  CHECK(out.str( ) == getExpectedOutput( ));// NOLINT
}
